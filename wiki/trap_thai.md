# [Linux] Bash trap การใช้งาน: จัดการสัญญาณและการหยุดการทำงาน

## Overview
คำสั่ง `trap` ใน Bash ใช้เพื่อจัดการกับสัญญาณและเหตุการณ์ที่เกิดขึ้นในระหว่างการทำงานของสคริปต์ โดยสามารถกำหนดให้มีการทำงานบางอย่างเมื่อมีสัญญาณหรือเหตุการณ์เฉพาะเกิดขึ้น เช่น การหยุดการทำงานของสคริปต์หรือการออกจากสคริปต์

## Usage
รูปแบบพื้นฐานของคำสั่ง `trap` คือ:

```bash
trap [options] [commands] [signals]
```

## Common Options
- `-p`: แสดงการตั้งค่าปัจจุบันของ trap
- `-l`: แสดงรายการของสัญญาณทั้งหมดที่สามารถใช้ได้
- `-n`: ใช้เพื่อไม่ให้ trap ทำงานในขณะกำหนด

## Common Examples
### ตัวอย่างที่ 1: จัดการกับสัญญาณ SIGINT
```bash
trap 'echo "Script interrupted"; exit' SIGINT
```
ในตัวอย่างนี้ เมื่อผู้ใช้กด `Ctrl+C` จะมีข้อความ "Script interrupted" แสดงขึ้นและสคริปต์จะออกจากการทำงาน

### ตัวอย่างที่ 2: ทำความสะอาดก่อนออกจากสคริปต์
```bash
trap 'rm -f /tmp/tempfile; echo "Temporary file removed"' EXIT
```
ในตัวอย่างนี้ เมื่อสคริปต์เสร็จสิ้นการทำงานหรือถูกหยุด จะมีการลบไฟล์ชั่วคราวและแสดงข้อความ

### ตัวอย่างที่ 3: จัดการกับสัญญาณ TERM
```bash
trap 'echo "Received TERM signal"; exit' TERM
```
ในตัวอย่างนี้ เมื่อมีสัญญาณ TERM ส่งเข้ามา จะมีข้อความ "Received TERM signal" แสดงขึ้นและสคริปต์จะออกจากการทำงาน

## Tips
- ใช้ `trap` เพื่อจัดการกับการทำงานที่ต้องทำก่อนที่จะออกจากสคริปต์ เช่น การลบไฟล์ชั่วคราวหรือการบันทึกข้อมูล
- ตรวจสอบให้แน่ใจว่าได้กำหนด trap สำหรับสัญญาณที่สำคัญ เช่น SIGINT และ SIGTERM เพื่อให้สคริปต์ทำงานอย่างราบรื่น
- ใช้ `trap -p` เพื่อตรวจสอบการตั้งค่าปัจจุบันของ trap ก่อนที่จะทำการเปลี่ยนแปลง